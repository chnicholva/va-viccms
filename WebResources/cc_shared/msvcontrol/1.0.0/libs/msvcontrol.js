/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)},MscrmControls;(function(MscrmControls){var FieldControls;(function(FieldControls){"use strict";var VirtualControl=function(){function VirtualControl(){}VirtualControl.prototype.init=function(context,notifyOutputChanged,state,container){this.context=context;this.notifyOutputChanged=notifyOutputChanged||function(){}};VirtualControl.prototype.destroy=function(){};VirtualControl.prototype.onPreNavigation=function(){};VirtualControl.prototype.updateView=function(context){this.context=context;return {}};VirtualControl.prototype.getOutputs=function(){return {}};VirtualControl.NO_VALUE_LABEL="---";return VirtualControl}();FieldControls.VirtualControl=VirtualControl})(FieldControls=MscrmControls.FieldControls||(MscrmControls.FieldControls={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var FieldControls;(function(FieldControls){"use strict";var VirtualOptionSetControl=function(_super){__extends(VirtualOptionSetControl,_super);function VirtualOptionSetControl(){_super.call(this);this._pointerEnd=false;this._onChange=this.onChangeHandler.bind(this);this._onFocus=this.onFocusHandler.bind(this);this._onBlur=this.onBlurHandler.bind(this);this._onContainerPointerEnter=this.onContainerPointerEnterHandler.bind(this);this._onContainerPointerLeave=this.onContainerPointerLeaveHandler.bind(this);this.modeManager=new FieldControls.ModeTransitionManager;this.modeManager.resetManager(this,this)}VirtualOptionSetControl.prototype.init=function(context,notifyOutputChanged,state,container){var _this=this;_super.prototype.init.call(this,context,notifyOutputChanged,state,container);var outputChangedCallback=notifyOutputChanged||function(){};this.notifyOutputChanged=function(){_this.waitingForValueSaved=true;outputChangedCallback()}};VirtualOptionSetControl.prototype.getOutputs=function(){this.waitingForValueSaved=false;return null};VirtualOptionSetControl.prototype.updateView=function(context){this.context=context;return this.component()};VirtualOptionSetControl.prototype.onChangeHandler=function(value){var candidate=!value||VirtualOptionSetControl.isUnassigned(value)?this.unassignedOptionWithPrompt():value;this.setControlValue(candidate);this.notifyOutputChanged()};VirtualOptionSetControl.prototype.onFocusHandler=function(){var active={id:FieldControls.ModeDescriptorID.ACTIVE};this.modeManager.requestTransitionTo(active)};VirtualOptionSetControl.prototype.onBlurHandler=function(){var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest)};VirtualOptionSetControl.prototype.onContainerPointerEnterHandler=function(){var hover={id:FieldControls.ModeDescriptorID.HOVER};this.modeManager.requestTransitionTo(hover)};VirtualOptionSetControl.prototype.onContainerPointerLeaveHandler=function(){this._pointerEnd=true;var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest)};VirtualOptionSetControl.prototype.idBundle=function(){return {}};VirtualOptionSetControl.prototype.valueForMode=function(mode){return VirtualOptionSetControl.UNASSIGNED_OPTION_VALUE};VirtualOptionSetControl.prototype.setControlValue=function(candidate){if(this._value!==candidate.Value)this._value=candidate.Value};VirtualOptionSetControl.prototype.isError=function(){return this.context.parameters.value.error};VirtualOptionSetControl.prototype.optionsList=function(){return []};VirtualOptionSetControl.prototype.arrowStyle=function(){var _a=this.context.theming,solidborderstyle=_a.solidborderstyle,textbox=_a.textbox;return {display:"flex",content:"",transform:"rotate(45deg)",borderStyle:solidborderstyle,borderTopWidth:0,borderLeftWith:0,borderRightWidth:textbox.linethickness,borderBottomWidth:textbox.linethickness,borderColor:this.isError()?textbox.redcolor:textbox.hoverboxcolor,width:VirtualOptionSetControl.OPTION_SET_ARROW_SIZE,height:VirtualOptionSetControl.OPTION_SET_ARROW_SIZE,marginTop:"calc(-1 * "+VirtualOptionSetControl.OPTION_SET_ARROW_SIZE+" * 0.666)"}};VirtualOptionSetControl.prototype.arrowContainerStyle=function(){var _a=this.context.theming,solidborderstyle=_a.solidborderstyle,textbox=_a.textbox,style={paddingLeft:textbox.horizontalpadding,paddingRight:textbox.horizontalpadding,paddingTop:textbox.verticalpadding,paddingBottom:textbox.verticalpadding,position:"relative",marginLeft:"calc(-1 * calc(2 * "+textbox.horizontalpadding+" + "+VirtualOptionSetControl.OPTION_SET_ARROW_SIZE+") - "+textbox.linethickness+")",borderTopWidth:0,borderBottomWidth:0,borderLeftWidth:0,borderRightWidth:0,flexDirection:"column",justifyContent:"center",flex:"0 1 auto",pointerEvents:"none",backgroundColor:"transparent"};if(this.modeManager.mode().id===FieldControls.ModeDescriptorID.ACTIVE){style["borderStyle"]=solidborderstyle;style["borderLeftWidth"]=textbox.linethickness;style["borderColor"]=this.isError()?textbox.redcolor:textbox.hoverboxcolor}return style};VirtualOptionSetControl.prototype.arrowComponent=function(){if(this.modeManager.mode().id===FieldControls.ModeDescriptorID.REST)return null;var arrowProps={id:this.idBundle().arrow,key:this.idBundle().arrow,style:this.arrowStyle()},arrow=this.context.factory.createElement("CONTAINER",arrowProps,null),containerProps={id:this.idBundle().arrowContainer,key:this.idBundle().arrowContainer,style:this.arrowContainerStyle()};return this.context.factory.createElement("CONTAINER",containerProps,arrow)};VirtualOptionSetControl.prototype.selectStyle=function(){var _a=this.context.theming,noneborderstyle=_a.noneborderstyle,textbox=_a.textbox,measure250=_a.measures.measure250,backgroundColor=this.modeManager.mode().id===FieldControls.ModeDescriptorID.ACTIVE?this.isError()?textbox.errorbackgroundcolor:textbox.backgroundcolor:"white",color=this.isError()?textbox.redcolor:textbox.contentcolor,selectStyle={appearance:"none",height:measure250,lineHeight:measure250,width:"100%","::-ms-expand":{display:"none"},paddingLeft:textbox.horizontalpadding,paddingRight:textbox.horizontalpadding,fontSize:this.isError()?textbox.errorfontsize:textbox.fontsize,fontWeight:this.modeManager.mode().id===FieldControls.ModeDescriptorID.REST||this.isError()?textbox.contentfontweight:textbox.fontweight,borderStyle:noneborderstyle,backgroundColor:backgroundColor,color:color},optionStyle={backgroundColor:backgroundColor,color:color};this.isControlDisabled()&&Object.assign(selectStyle,FieldControls.ThemingHelper.getDisableStyle(this.context.theming));var scope=this.context.parameters.scope;FieldControls.ThemingHelper.isFooterCell(scope)&&Object.assign(selectStyle,FieldControls.ThemingHelper.getFooterStyle(this.context.theming));FieldControls.ThemingHelper.isHeaderCell(scope)&&Object.assign(selectStyle,FieldControls.ThemingHelper.getHeaderStyle(this.context.theming));return {selectStyle:selectStyle,optionStyle:optionStyle}};VirtualOptionSetControl.prototype.selectComponent=function(){var options=this.optionsList(),plainValue=this.valueForMode(this.modeManager.mode()),value=this.unassignedOptionWithPrompt(false);value=this.optionWithValue(plainValue,options);if(!this.context.parameters.value.security.readable)value=this.nonReadableOption(this.modeManager.mode().id!==FieldControls.ModeDescriptorID.REST,value);var disabled=this.isControlDisabled(),style=this.selectStyle();value&&this.setControlValue(value);var describedByElementId="";if(this.context.parameters&&this.context.parameters.describedByElementId)describedByElementId=this.context.parameters.describedByElementId.raw;var selectProps={id:this.idBundle().select,key:this.idBundle().select,describedByElementId:describedByElementId,onChange:this._onChange,onFocus:disabled?null:this._onFocus,onBlur:disabled?null:this._onBlur,error:this.isError(),value:value,disabled:disabled,options:options,accessibilityRequired:this.context.parameters.value.attributes.RequiredLevel===1||this.context.parameters.value.attributes.RequiredLevel===2?true:null,style:style},select=this.context.factory.createElement("SELECT",selectProps,null),containerProps={id:this.idBundle().selectContainer,key:this.idBundle().selectContainer,style:{flex:"1 1 auto",left:"0px",right:"0px",top:"0px",position:"absolute",width:"100%"}};return this.context.factory.createElement("CONTAINER",containerProps,select)};VirtualOptionSetControl.prototype.containerStyle=function(){var _a=this.context.theming,solidborderstyle=_a.solidborderstyle,noneborderstyle=_a.noneborderstyle,textbox=_a.textbox,borderColor=this.modeManager.mode().id===FieldControls.ModeDescriptorID.REST?"transparent":this.isError()?textbox.redcolor:textbox.hoverboxcolor;return {width:"100%",overflow:"hidden",background:"transparent",borderWidth:this.isError()?textbox.errorlinethickness:textbox.linethickness,borderStyle:solidborderstyle,borderColor:borderColor,display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",position:"relative",height:"32.6px"}};VirtualOptionSetControl.prototype.component=function(){var select=this.selectComponent(),arrow=this.arrowComponent(),containerProps={id:this.idBundle().container,key:this.idBundle().container,style:this.containerStyle(),onPointerEnter:this.isControlDisabled()?null:this._onContainerPointerEnter,onPointerLeave:this.isControlDisabled()?null:this._onContainerPointerLeave};return this.context.factory.createElement("CONTAINER",containerProps,[select,arrow])};VirtualOptionSetControl.prototype.unassignedOptionWithPrompt=function(prompt){if(prompt===void 0)prompt=true;return {Label:prompt?VirtualOptionSetControl.UNASSIGNED_OPTION_LABEL_PROMPT:VirtualOptionSetControl.UNASSIGNED_OPTION_LABEL,Value:VirtualOptionSetControl.UNASSIGNED_OPTION_VALUE,Color:null}};VirtualOptionSetControl.prototype.nonReadableOption=function(isActive,value){if(isActive===void 0)isActive=true;return {Label:isActive?value?value.Label:VirtualOptionSetControl.UNASSIGNED_OPTION_LABEL_PROMPT:VirtualOptionSetControl.NOT_READABLE_VALUE,Value:isActive?value?value.Value:VirtualOptionSetControl.UNASSIGNED_OPTION_VALUE:VirtualOptionSetControl.UNASSIGNED_OPTION_VALUE,Color:null}};VirtualOptionSetControl.prototype.optionWithValue=function(value,options){var candidates=options&&options.filter(function(option){return option.Value===value});if(candidates&&candidates.length>0)return candidates[0];return this.unassignedOptionWithPrompt(false)};VirtualOptionSetControl.isUnassigned=function(candidate){if(!candidate)return false;return !candidate.Value&&candidate.Value!==0||candidate.Value&&!~candidate.Value};VirtualOptionSetControl.prototype.defaultMode=function(){return {id:FieldControls.ModeDescriptorID.REST}};VirtualOptionSetControl.prototype.isTransitionAllowed=function(from,to){var allowed=false;switch(from.id){case FieldControls.ModeDescriptorID.REST:case FieldControls.ModeDescriptorID.HOVER:allowed=true;break;case FieldControls.ModeDescriptorID.ACTIVE:allowed=!(to.id===FieldControls.ModeDescriptorID.REST&&this._pointerEnd||to.id===FieldControls.ModeDescriptorID.HOVER);break;default:break}this._pointerEnd=false;return allowed};VirtualOptionSetControl.prototype.transitionWillApply=function(from,to){from.id===FieldControls.ModeDescriptorID.ACTIVE&&to.id===FieldControls.ModeDescriptorID.REST&&this.notifyOutputChanged()};VirtualOptionSetControl.prototype.transitionDidApply=function(from,to){this.context.utils.requestRender()};VirtualOptionSetControl.prototype.isControlDisabled=function(){return this.context.mode.isControlDisabled||!this.context.parameters.value.security.editable||this.context.page&&this.context.page.isPageReadOnly};VirtualOptionSetControl.UNASSIGNED_OPTION_VALUE=-1;VirtualOptionSetControl.UNASSIGNED_OPTION_LABEL="---";VirtualOptionSetControl.UNASSIGNED_OPTION_LABEL_PROMPT="VirtualOptionSetControl_Unassigned_Option_Label_Prompt";VirtualOptionSetControl.NOT_READABLE_VALUE="******";VirtualOptionSetControl.OPTION_SET_ARROW_SIZE="0.6em";return VirtualOptionSetControl}(FieldControls.VirtualControl);FieldControls.VirtualOptionSetControl=VirtualOptionSetControl})(FieldControls=MscrmControls.FieldControls||(MscrmControls.FieldControls={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var FieldControls;(function(FieldControls){"use strict";var VirtualNumberControl=function(_super){__extends(VirtualNumberControl,_super);function VirtualNumberControl(){_super.call(this);this._changeHandler=this.onChange.bind(this);this._focusHandler=this.onFocus.bind(this);this._blurHandler=this.onBlur.bind(this);this._pointerEnterHandler=this.onPointerEnter.bind(this);this._pointerLeaveHandler=this.onPointerLeave.bind(this);this.modeManager=new FieldControls.ModeTransitionManager;this.modeManager.resetManager(this,this)}VirtualNumberControl.prototype.init=function(context,notifyOutputChanged,state,container){var _this=this;_super.prototype.init.call(this,context,notifyOutputChanged,state,container);var outputChangedCallback=notifyOutputChanged||function(){};this.notifyOutputChanged=function(){_this.waitingForValueSaved=true;outputChangedCallback()}};VirtualNumberControl.prototype.getOutputs=function(){this.waitingForValueSaved=false;return null};VirtualNumberControl.prototype.idBundle=function(){return {}};VirtualNumberControl.prototype.setControlValue=function(candidate){};VirtualNumberControl.prototype.valueForMode=function(mode){return ""};VirtualNumberControl.prototype.isError=function(){return this.context.parameters.value.error};VirtualNumberControl.prototype.tryConvertToNumber=function(candidate){return candidate};VirtualNumberControl.prototype.component=function(){return this.context.factory.createElement("TEXTINPUT",this.propsForMode(this.modeManager.mode()))};VirtualNumberControl.prototype.propsForMode=function(mode){var disabled=this.isControlDisabled(),style=this.styleForMode(mode),describedByElementId="";if(this.context.parameters&&this.context.parameters.describedByElementId)describedByElementId=this.context.parameters.describedByElementId.raw;return {id:this.idBundle().input,key:this.idBundle().input,value:this.valueForMode(mode),readOnly:disabled,accessibilityLive:"assertive",error:this.isError(),describedByElementId:describedByElementId,style:style,selectValueOnFocus:true,accessibilityRequired:this.context.parameters.value.attributes.RequiredLevel===1||this.context.parameters.value.attributes.RequiredLevel===2?true:null,onFocus:disabled?null:this._focusHandler,onBlur:disabled?null:this._blurHandler,onChange:disabled?null:this._changeHandler,onPointerEnter:disabled?null:this._pointerEnterHandler,onPointerLeave:disabled?null:this._pointerLeaveHandler}};VirtualNumberControl.prototype.styleForMode=function(mode){var theming=this.context.theming,scope=this.context.parameters.scope,deviceSizeMode=this.context.parameters.deviceSizeMode,isRTL=this.context.userSettings.isRTL;switch(mode.id){case FieldControls.ModeDescriptorID.REST:return this.restStyle(theming,deviceSizeMode,scope,isRTL,this.isError());case FieldControls.ModeDescriptorID.HOVER:return this.hoverStyle(theming,deviceSizeMode,scope,isRTL,this.isError());case FieldControls.ModeDescriptorID.ACTIVE:return this.activeStyle(theming,deviceSizeMode,scope,isRTL,this.isError());default:break}return {}};VirtualNumberControl.prototype.restStyle=function(theming,deviceSizeMode,scope,isRTL,error){return FieldControls.ThemingHelper.getReadModeStyle(theming,deviceSizeMode,scope,isRTL,error,this.isControlDisabled())};VirtualNumberControl.prototype.hoverStyle=function(theming,deviceSizeMode,scope,isRTL,error){return this.activeStyle(theming,deviceSizeMode,scope,isRTL,error)};VirtualNumberControl.prototype.activeStyle=function(theming,deviceSizeMode,scope,isRTL,error){return FieldControls.ThemingHelper.getEditModeStyle(theming,deviceSizeMode,scope,isRTL,error)};VirtualNumberControl.prototype.updateView=function(context){this.context=context;return this.component()};VirtualNumberControl.prototype.onFocus=function(){var active={id:FieldControls.ModeDescriptorID.ACTIVE};this.modeManager.requestTransitionTo(active)};VirtualNumberControl.prototype.onBlur=function(){var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest)};VirtualNumberControl.prototype.onChange=function(event){var candidate=event.target.value;this.setControlValue(this.tryConvertToNumber(candidate))};VirtualNumberControl.prototype.onPointerEnter=function(){var hover={id:FieldControls.ModeDescriptorID.HOVER};this.modeManager.requestTransitionTo(hover)};VirtualNumberControl.prototype.onPointerLeave=function(){this._pointerEnd=true;var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest)};VirtualNumberControl.prototype.defaultMode=function(){return {id:FieldControls.ModeDescriptorID.REST}};VirtualNumberControl.prototype.isTransitionAllowed=function(from,to){var allowed=false;switch(from.id){case FieldControls.ModeDescriptorID.REST:case FieldControls.ModeDescriptorID.HOVER:allowed=true;break;case FieldControls.ModeDescriptorID.ACTIVE:allowed=!(to.id===FieldControls.ModeDescriptorID.REST&&this._pointerEnd||to.id===FieldControls.ModeDescriptorID.HOVER);break;default:break}this._pointerEnd=false;return allowed};VirtualNumberControl.prototype.transitionWillApply=function(from,to){from.id===FieldControls.ModeDescriptorID.ACTIVE&&to.id===FieldControls.ModeDescriptorID.REST&&this.notifyOutputChanged()};VirtualNumberControl.prototype.transitionDidApply=function(from,to){this.context.utils.requestRender()};VirtualNumberControl.prototype.isControlDisabled=function(){return this.context.mode.isControlDisabled||!this.context.parameters.value.security.editable||this.context.page&&this.context.page.isPageReadOnly};VirtualNumberControl.UPDATE_LABEL_EVENT="getLabelUniqueId";VirtualNumberControl.DEFAULT_VALUE_LABEL="---";VirtualNumberControl.NOT_READABLE_VALUE="******";return VirtualNumberControl}(FieldControls.VirtualControl);FieldControls.VirtualNumberControl=VirtualNumberControl})(FieldControls=MscrmControls.FieldControls||(MscrmControls.FieldControls={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var FieldControls;(function(FieldControls){"use strict";var VirtualActionControl=function(_super){__extends(VirtualActionControl,_super);function VirtualActionControl(){_super.call(this);this._pointerEnd=false;this._focusInputHandler=this.onInputFocus.bind(this);this._blurInputHandler=this.onInputBlur.bind(this);this._changeInputHandler=this.onInputChange.bind(this);this._keyDownInputHandler=this.onInputKeyDown.bind(this);this._clickButtonHandler=this.onActionTrigger.bind(this);this._pointerDownButtonHandler=this.onPointerDownButton.bind(this);this._focusButtonHandler=this.onButtonFocus.bind(this);this._blurButtonHandler=this.onButtonBlur.bind(this);this._keyDownButtonHandler=this.onButtonKeyDown.bind(this);this._pointerEnterContainerHandler=this.onContainerPointerEnter.bind(this);this._pointerLeaveContainerHandler=this.onContainerPointerLeave.bind(this);this.modeManager=new FieldControls.ModeTransitionManager;this.modeManager.resetManager(this,this)}VirtualActionControl.prototype.init=function(context,notifyOutputChanged,state,container){var _this=this;_super.prototype.init.call(this,context,notifyOutputChanged,state,container);var outputChangedCallback=notifyOutputChanged||function(){};this.notifyOutputChanged=function(){_this.waitingForValueSaved=true;outputChangedCallback()}};VirtualActionControl.prototype.getOutputs=function(){this.waitingForValueSaved=false;return null};VirtualActionControl.prototype.action=function(){};VirtualActionControl.prototype.idBundle=function(){return {}};VirtualActionControl.prototype.actionIconProps=function(){return {}};VirtualActionControl.prototype.ariaDescription=function(){return ""};VirtualActionControl.prototype.placeholder=function(){return ""};VirtualActionControl.prototype.setControlValue=function(candidate){};VirtualActionControl.prototype.valueForMode=function(mode){return ""};VirtualActionControl.prototype.isError=function(){return this.context.parameters.value.error};VirtualActionControl.prototype.propsForMode=function(mode,ariaDescriptorId){var style=this.styleForMode(mode),describedByElementId=ariaDescriptorId?this.context.accessibility.getUniqueId(ariaDescriptorId):null,disabled=this.isControlDisabled();if(this.context.parameters&&this.context.parameters.describedByElementId)describedByElementId=!describedByElementId?this.context.parameters.describedByElementId.raw:" "+this.context.parameters.describedByElementId.raw;return {id:this.idBundle().input,key:this.idBundle().input,value:this.valueForMode(mode),placeholder:this.placeholder(),readOnly:disabled,error:this.isError(),describedByElementId:describedByElementId,style:style,selectValueOnFocus:true,onFocus:disabled?null:this._focusInputHandler,onBlur:disabled?null:this._blurInputHandler,onChange:disabled?null:this._changeInputHandler,onKeyDown:this._keyDownInputHandler,accessibilityRequired:this.context.parameters.value.attributes.RequiredLevel===1||this.context.parameters.value.attributes.RequiredLevel===2?true:null}};VirtualActionControl.prototype.styleForMode=function(mode){var theming=this.context.theming,scope=this.context.parameters.scope,deviceSizeMode=this.context.parameters.deviceSizeMode;switch(mode.id){case FieldControls.ModeDescriptorID.REST:return this.restStyle(theming,deviceSizeMode,scope,this.isError());case FieldControls.ModeDescriptorID.HOVER:return this.hoverStyle(theming,deviceSizeMode,scope,this.isError());case FieldControls.ModeDescriptorID.ACTIVE:return this.activeStyle(theming,deviceSizeMode,scope,this.isError());default:break}return {}};VirtualActionControl.prototype.isValueSet=function(mode){var value=this.valueForMode({id:mode});return !this.context.utils.isNullOrUndefined(value)&&value.toString()!==VirtualActionControl.DEFAULT_VALUE_LABEL};VirtualActionControl.prototype.restStyle=function(theming,deviceSizeMode,scope,error){var isValueSet=this.isValueSet(FieldControls.ModeDescriptorID.REST),isRTL=this.context.userSettings.isRTL;return FieldControls.ThemingHelper.getReadModeStyle(theming,deviceSizeMode,scope,isRTL,error,this.isControlDisabled(),isValueSet)};VirtualActionControl.prototype.hoverStyle=function(theming,deviceSizeMode,scope,error){return this.activeStyle(theming,deviceSizeMode,scope,error)};VirtualActionControl.prototype.activeStyle=function(theming,deviceSizeMode,scope,error){var isValueSet=this.isValueSet(FieldControls.ModeDescriptorID.ACTIVE),isRTL=this.context.userSettings.isRTL,editStyle=FieldControls.ThemingHelper.getEditModeStyle(theming,deviceSizeMode,scope,isRTL,error,isValueSet);editStyle["border-radius"]="0px";editStyle["-moz-appearance"]="none";editStyle["-webkit-appearance"]="none";editStyle["-appearance"]="none";editStyle["borderStyle"]="solid";return editStyle};VirtualActionControl.prototype.actionButtonStyle=function(theming,isRTL,error,mode){var isRestMode=mode.id===FieldControls.ModeDescriptorID.REST;return FieldControls.ThemingHelper.getActionIconStyle(theming,isRTL,error,isRestMode)};VirtualActionControl.prototype.getLiveContainerProps=function(){return {style:{position:"absolute",clip:"rect(1px, 1px, 1px, 1px)"},role:"alert",accessibilityLive:"assertive",key:"aria-live-container"}};VirtualActionControl.prototype.setLiveContainerNotification=function(message){this._accessibilityNotificationMessage=message;this.context.utils.requestRender()};VirtualActionControl.prototype.actionButtonType=function(){return "MICROSOFTICON"};VirtualActionControl.prototype.component=function(){var disabled=this.isControlDisabled(),isValueSet=this.isValueSet(FieldControls.ModeDescriptorID.ACTIVE),actionBtn=null;if(isValueSet){var _a=this.actionIconProps(),accessibilityLabel=_a.accessibilityLabel,type=_a.type,isError=this.context.parameters.value.error;actionBtn=this.context.factory.createElement(this.actionButtonType(),{id:this.idBundle().icon,key:this.idBundle().icon,role:"button",accessibilityLabel:accessibilityLabel,type:type,tabIndex:0,onClick:isError?null:this._clickButtonHandler,onPointerDown:isError?null:this._pointerDownButtonHandler,onFocus:isError?null:this._focusButtonHandler,onBlur:isError?null:this._blurButtonHandler,onKeyDown:isError?null:this._keyDownButtonHandler,style:this.actionButtonStyle(this.context.theming,this.context.userSettings.isRTL,this.isError(),this.modeManager.mode())})}var ariaDescriptor=this.context.factory.createElement("LABEL",{id:this.idBundle().ariaDescriptor,key:this.idBundle().ariaDescriptor,style:{display:"none"}},this.ariaDescription()),liveRegion=this.context.factory.createElement("CONTAINER",this.getLiveContainerProps(),this._accessibilityNotificationMessage||""),input=this.context.factory.createElement("TEXTINPUT",this.propsForMode(this.modeManager.mode(),this.idBundle().ariaDescriptor));return this.context.factory.createElement("CONTAINER",{id:this.idBundle().container,key:this.idBundle().container,onPointerEnter:disabled?null:this._pointerEnterContainerHandler,onPointerLeave:disabled?null:this._pointerLeaveContainerHandler,style:{position:"relative",display:"flex",alignItems:"center",width:"100%"}},[liveRegion,input,ariaDescriptor,actionBtn])};VirtualActionControl.prototype.updateView=function(context){this.context=context;return this.component()};VirtualActionControl.prototype.onInputFocus=function(){var active={id:FieldControls.ModeDescriptorID.ACTIVE};this.modeManager.requestTransitionTo(active)};VirtualActionControl.prototype.onInputBlur=function(){var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest,true)};VirtualActionControl.prototype.onInputChange=function(event){var candidate=event.target.value;this.setControlValue(candidate)};VirtualActionControl.prototype.onInputKeyDown=function(event){if(!event)return;switch(event.keyCode){case 13:event.ctrlKey&&this.action();break;default:break}};VirtualActionControl.prototype.onContainerPointerEnter=function(){var hover={id:FieldControls.ModeDescriptorID.HOVER};this.modeManager.requestTransitionTo(hover)};VirtualActionControl.prototype.onContainerPointerLeave=function(){this._pointerEnd=true;var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest)};VirtualActionControl.prototype.onActionTrigger=function(){this.action()};VirtualActionControl.prototype.onPointerDownButton=function(){};VirtualActionControl.prototype.onButtonFocus=function(){var active={id:FieldControls.ModeDescriptorID.ACTIVE};this.modeManager.requestTransitionTo(active)};VirtualActionControl.prototype.onButtonBlur=function(){var rest={id:FieldControls.ModeDescriptorID.REST};this.modeManager.requestTransitionTo(rest,true)};VirtualActionControl.prototype.onButtonKeyDown=function(event){if(!event)return;switch(event.keyCode){case 13:this.action();break;default:break}};VirtualActionControl.prototype.defaultMode=function(){return {id:FieldControls.ModeDescriptorID.REST}};VirtualActionControl.prototype.isTransitionAllowed=function(from,to){var allowed=false;switch(from.id){case FieldControls.ModeDescriptorID.REST:case FieldControls.ModeDescriptorID.HOVER:allowed=true;break;case FieldControls.ModeDescriptorID.ACTIVE:allowed=!(to.id===FieldControls.ModeDescriptorID.REST&&this._pointerEnd||to.id===FieldControls.ModeDescriptorID.HOVER);break;default:break}this._pointerEnd=false;return allowed};VirtualActionControl.prototype.transitionWillApply=function(from,to){from.id===FieldControls.ModeDescriptorID.ACTIVE&&to.id===FieldControls.ModeDescriptorID.REST&&this.notifyOutputChanged()};VirtualActionControl.prototype.transitionDidApply=function(from,to){this.context.utils.requestRender()};VirtualActionControl.prototype.isControlDisabled=function(){return this.context.mode.isControlDisabled||!this.context.parameters.value.security.editable||this.context.page&&this.context.page.isPageReadOnly};VirtualActionControl.UPDATE_LABEL_EVENT="getLabelUniqueId";VirtualActionControl.DEFAULT_VALUE_LABEL="---";return VirtualActionControl}(FieldControls.VirtualControl);FieldControls.VirtualActionControl=VirtualActionControl})(FieldControls=MscrmControls.FieldControls||(MscrmControls.FieldControls={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var FieldControls;(function(FieldControls){"use strict";(function(ModeDescriptorID){ModeDescriptorID[ModeDescriptorID["NONE"]=-1]="NONE";ModeDescriptorID[ModeDescriptorID["REST"]=1]="REST";ModeDescriptorID[ModeDescriptorID["HOVER"]=2]="HOVER";ModeDescriptorID[ModeDescriptorID["ACTIVE"]=3]="ACTIVE"})(FieldControls.ModeDescriptorID||(FieldControls.ModeDescriptorID={}));var ModeDescriptorID=FieldControls.ModeDescriptorID,ModeTransitionManager=function(){function ModeTransitionManager(){}ModeTransitionManager.prototype.mode=function(){return this._mode};ModeTransitionManager.prototype.resetManager=function(dataSource,delegate){this._delegate=delegate;this._mode=ModeTransitionManager._EMPTY_MODE;if(dataSource&&dataSource.defaultMode)this._mode=dataSource.defaultMode()||ModeTransitionManager._EMPTY_MODE;this._transition=ModeTransitionManager._EMPTY_MODE};ModeTransitionManager.prototype.requestTransitionTo=function(to,forceAsync){var _this=this;if(forceAsync===void 0)forceAsync=false;this._transition=to;if(forceAsync)setTimeout(function(){_this._flushTransition()},0);else this._flushTransition()};ModeTransitionManager._isEmptyMode=function(candidate){return ModeTransitionManager._EMPTY_MODE.id===candidate.id};ModeTransitionManager.prototype._flushTransition=function(){if(!this._transition||ModeTransitionManager._isEmptyMode(this._transition)||this._mode.id===this._transition.id){this._transition=ModeTransitionManager._EMPTY_MODE;return}var transitionAllowed=true;if(this._delegate&&this._delegate.isTransitionAllowed)transitionAllowed=this._delegate.isTransitionAllowed(this._mode,this._transition);if(!transitionAllowed){this._transition=ModeTransitionManager._EMPTY_MODE;return}this._delegate&&this._delegate.transitionWillApply&&this._delegate.transitionWillApply(this._mode,this._transition);var to=this._transition,from=this._mode;this._mode=this._transition;this._transition=ModeTransitionManager._EMPTY_MODE;this._delegate&&this._delegate.transitionDidApply&&this._delegate.transitionDidApply(from,to)};ModeTransitionManager._EMPTY_MODE={id:ModeDescriptorID.NONE};return ModeTransitionManager}();FieldControls.ModeTransitionManager=ModeTransitionManager})(FieldControls=MscrmControls.FieldControls||(MscrmControls.FieldControls={}))})(MscrmControls||(MscrmControls={}));var MscrmControls;(function(MscrmControls){var FieldControls;(function(FieldControls){"use strict";var SizeMode;(function(SizeMode){SizeMode[SizeMode["Fullmode"]=0]="Fullmode";SizeMode[SizeMode["Sbreakpoint"]=1]="Sbreakpoint";SizeMode[SizeMode["Mbreakpoint"]=2]="Mbreakpoint"})(SizeMode||(SizeMode={}));var CellScope;(function(CellScope){CellScope[CellScope["Header"]=0]="Header";CellScope[CellScope["EditForm"]=1]="EditForm";CellScope[CellScope["Footer"]=2]="Footer"})(CellScope||(CellScope={}));var ThemingHelper=function(){function ThemingHelper(){}ThemingHelper.isHeaderCell=function(scope){return scope&&scope.raw===CellScope.Header};ThemingHelper.isFooterCell=function(scope){return scope&&scope.raw===CellScope.Footer};ThemingHelper.getCommonStyle=function(theming,deviceSizeMode,scope,isRTL,error,isIconAvailable){var _a=theming.textbox,contentfontweight=_a.contentfontweight,linethickness=_a.linethickness,errorlinethickness=_a.errorlinethickness,solidborderstyle=theming.solidborderstyle,_b=theming.measures,measure050=_b.measure050,measure250=_b.measure250,font100=theming.fontsizes.font100,_c=theming.colors.basecolor,red=_c.red,black=_c.black,paddingLeft=measure050,paddingRight=measure050;if(isIconAvailable){var iconWidth=ThemingHelper.getActionIconWidth(theming);paddingLeft=isRTL?iconWidth:paddingLeft;paddingRight=isRTL?paddingRight:iconWidth}return {boxSizing:"border-box",height:measure250,lineHeight:measure250,width:"100%",textOverflow:"ellipsis",fontSize:font100,fontWeight:contentfontweight,color:error?red["red3"]:black,paddingLeft:paddingLeft,paddingRight:paddingRight,paddingTop:"0px",paddingBottom:"0px",borderStyle:solidborderstyle,borderWidth:error?errorlinethickness:linethickness}};ThemingHelper.getDisableStyle=function(theming){return {borderWidth:theming.textbox.linethickness,borderStyle:theming.solidborderstyle,borderColor:"transparent",color:theming.colors.grays.gray07,opacity:1,"-webkit-text-fill-color":theming.colors.grays.gray07,cursor:"default",fontSize:theming.fontsizes.font100,fontFamily:theming.fontfamilies.regular,textDecoration:"none",":hover":{backgroundColor:theming.colors.grays.gray02,borderColor:theming.colors.grays.gray02}}};ThemingHelper.getEditModeStyle=function(theming,deviceSizeMode,scope,isRTL,error,isIconAvailable){var commonStyles=ThemingHelper.getCommonStyle(theming,deviceSizeMode,scope,isRTL,error,isIconAvailable),_a=theming.textbox,redcolor=_a.redcolor,hoverboxcolor=_a.hoverboxcolor,errorbackgroundcolor=_a.errorbackgroundcolor,backgroundcolor=_a.backgroundcolor,fontweight=_a.fontweight,contentfontweight=_a.contentfontweight,editModeStyles={fontWeight:error?contentfontweight:fontweight,backgroundColor:error?errorbackgroundcolor:backgroundcolor,borderColor:error?redcolor:hoverboxcolor,":hover":{}},headerStyles=ThemingHelper.isHeaderCell(scope)?ThemingHelper.getHeaderStyle(theming):undefined,footerStyles=ThemingHelper.isFooterCell(scope)?ThemingHelper.getFooterStyle(theming):undefined;return Object.assign({},commonStyles,editModeStyles,headerStyles,footerStyles)};ThemingHelper.getReadModeStyle=function(theming,deviceSizeMode,scope,isRTL,error,isControlDisabled,isIconAvailable){var commonStyles=ThemingHelper.getCommonStyle(theming,deviceSizeMode,scope,isRTL,error,isIconAvailable),disableStyles=isControlDisabled?ThemingHelper.getDisableStyle(theming):undefined,headerStyles=ThemingHelper.isHeaderCell(scope)?ThemingHelper.getHeaderStyle(theming):undefined,footerStyles=ThemingHelper.isFooterCell(scope)?ThemingHelper.getFooterStyle(theming):undefined,readModeStyle={borderColor:"transparent",":hover":!isControlDisabled?ThemingHelper.getEditModeStyle(theming,deviceSizeMode,scope,isRTL,error):{}};return Object.assign({},commonStyles,readModeStyle,disableStyles,headerStyles,footerStyles)};ThemingHelper.getHeaderStyle=function(theming){var font125=theming.fontsizes.font125,grey=theming.colors.basecolor.grey,semilight=theming.fontfamilies.semilight;return {color:grey["grey7"],fontSize:font125,fontFamily:semilight}};ThemingHelper.getFooterStyle=function(theming){var font085=theming.fontsizes.font085,grey=theming.colors.basecolor.grey,regular=theming.fontfamilies.regular,fontweight=theming.textbox.fontweight;return {fontWeight:fontweight,color:grey["grey7"],fontSize:font085,fontFamily:regular,backgroundColor:grey["grey3"],":hover":{backgroundColor:grey["grey3"],borderColor:"transparent"}}};ThemingHelper.getActionIconStyle=function(theming,isRTL,error,isRestMode){var _a=theming.textbox,lineheight=_a.lineheight,horizontalpadding=_a.horizontalpadding,verticalpadding=_a.verticalpadding,linethickness=_a.linethickness,errorlinethickness=_a.errorlinethickness,iconSpace=lineheight+" + "+horizontalpadding+" + "+horizontalpadding,borderWidth=error?errorlinethickness:linethickness,right="0px",left="0px",widthDeficit="("+iconSpace+" + "+borderWidth+")";if(isRTL){left=linethickness;right="calc(100% - "+widthDeficit+")"}else{left="calc(100% - "+widthDeficit+")";right=linethickness}return {position:"absolute",top:linethickness,right:right,left:left,bottom:linethickness,cursor:"pointer",color:isRestMode?"":theming.colors.basecolor.grey.grey7,background:isRestMode?"":theming.colors.basecolor.grey.grey3,lineHeight:lineheight,width:lineheight,textAlign:"center",paddingLeft:horizontalpadding,paddingRight:horizontalpadding,paddingTop:verticalpadding,paddingBottom:verticalpadding}};ThemingHelper.getActionIconWidth=function(theming){var _a=theming.textbox,lineheight=_a.lineheight,horizontalpadding=_a.horizontalpadding;return "calc("+lineheight+" + "+horizontalpadding+" + "+horizontalpadding+")"};ThemingHelper.getOutlineStyle=function(theming){var solidborderstyle=theming.solidborderstyle,_a=theming.textbox,hoverboxcolor=_a.hoverboxcolor,linethickness=_a.linethickness;return {outlineColor:hoverboxcolor,outlineWidth:linethickness,outlineStyle:solidborderstyle}};return ThemingHelper}();FieldControls.ThemingHelper=ThemingHelper})(FieldControls=MscrmControls.FieldControls||(MscrmControls.FieldControls={}))})(MscrmControls||(MscrmControls={}))