/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
/** @license Copyright (c) Microsoft Corporation. All rights reserved. */
var __extends=this&&this.__extends||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p];function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)},MscrmCommon;(function(MscrmCommon){var ErrorHandling;(function(ErrorHandling){"use strict";var ErrorCode=function(){function ErrorCode(){}ErrorCode.ValueOutOfRangeId="CustomControl_OutOfRange_Error";ErrorCode.InvalidInputMaskId="CustomControl_InvalidInput_Error";ErrorCode.MaxLengthExceededId="CustomControl_MaxLengthExceeded_Error";return ErrorCode}();ErrorHandling.ErrorCode=ErrorCode})(ErrorHandling=MscrmCommon.ErrorHandling||(MscrmCommon.ErrorHandling={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ErrorHandling;(function(ErrorHandling){"use strict";var NotificationHandler=function(){function NotificationHandler(setNotification,clearNotification){this.setNotification=setNotification;this.clearNotification=clearNotification;this.setNotification=setNotification;this.clearNotification=clearNotification}NotificationHandler.prototype.notify=function(message,id){this.setNotification(message,id)};NotificationHandler.prototype.clear=function(id){this.clearNotification(id)};return NotificationHandler}();ErrorHandling.NotificationHandler=NotificationHandler})(ErrorHandling=MscrmCommon.ErrorHandling||(MscrmCommon.ErrorHandling={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ErrorHandling;(function(ErrorHandling){"use strict";var ExceptionHandler=function(){function ExceptionHandler(){}ExceptionHandler.throwException=function(message){throw message};return ExceptionHandler}();ErrorHandling.ExceptionHandler=ExceptionHandler})(ErrorHandling=MscrmCommon.ErrorHandling||(MscrmCommon.ErrorHandling={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";(function(ProgressIndicatorType){ProgressIndicatorType[ProgressIndicatorType["Bar"]=0]="Bar";ProgressIndicatorType[ProgressIndicatorType["Ring"]=1]="Ring"})(MscrmCommon.ProgressIndicatorType||(MscrmCommon.ProgressIndicatorType={}));var ProgressIndicatorType=MscrmCommon.ProgressIndicatorType})(MscrmCommon||(MscrmCommon={}));var Mscrm;(function(Mscrm){"use strict";(function(AttributeSourceType){AttributeSourceType[AttributeSourceType["Unknown"]=-1]="Unknown";AttributeSourceType[AttributeSourceType["Persistent"]=0]="Persistent";AttributeSourceType[AttributeSourceType["Calculated"]=1]="Calculated";AttributeSourceType[AttributeSourceType["Rollup"]=2]="Rollup"})(Mscrm.AttributeSourceType||(Mscrm.AttributeSourceType={}));var AttributeSourceType=Mscrm.AttributeSourceType})(Mscrm||(Mscrm={}));var Mscrm;(function(Mscrm){"use strict";(function(UpdateEventType){UpdateEventType[UpdateEventType["DataSet"]=0]="DataSet";UpdateEventType[UpdateEventType["Layout"]=1]="Layout";UpdateEventType[UpdateEventType["Activation"]=2]="Activation";UpdateEventType[UpdateEventType["Theming"]=3]="Theming"})(Mscrm.UpdateEventType||(Mscrm.UpdateEventType={}));var UpdateEventType=Mscrm.UpdateEventType,UpdateEvents=function(){function UpdateEvents(){this.ignoredEvents={};this.ignoredEvents[Mscrm.UpdateEventType.DataSet]=false;this.ignoredEvents[Mscrm.UpdateEventType.Layout]=false;this.ignoredEvents[Mscrm.UpdateEventType.Activation]=true;this.ignoredEvents[Mscrm.UpdateEventType.Theming]=false}UpdateEvents.getEventType=function(event){switch(event){case "dataset":return Mscrm.UpdateEventType.DataSet;case "layout":return Mscrm.UpdateEventType.Layout;case "activation":return Mscrm.UpdateEventType.Activation;case "theming":return Mscrm.UpdateEventType.Theming;default:return null}};UpdateEvents.getEventCode=function(event){switch(event){case Mscrm.UpdateEventType.DataSet:return "dataset";case Mscrm.UpdateEventType.Layout:return "layout";case Mscrm.UpdateEventType.Activation:return "activation";case Mscrm.UpdateEventType.Theming:return "theming";default:return null}};UpdateEvents.prototype.shouldIgnoreEvent=function(event,shouldIgnore){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(event))this.ignoredEvents[event]=shouldIgnore};UpdateEvents.prototype.isIgnoredEvent=function(event){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(event))return this.ignoredEvents[event];return false};UpdateEvents.hasEvent=function(updatedProperties,event){var eventCode=UpdateEvents.getEventCode(event);return (new MscrmCommon.ArrayQuery(updatedProperties)).contains(function(item){return item==eventCode})};return UpdateEvents}();Mscrm.UpdateEvents=UpdateEvents})(Mscrm||(Mscrm={}));var MscrmCommon;(function(MscrmCommon){"use strict";var AttributeConstants=function(){function AttributeConstants(){}AttributeConstants.Checked="checked";AttributeConstants.ReadOnly="readonly";AttributeConstants.Disabled="disabled";AttributeConstants.Style="style";AttributeConstants.Layout="layout";return AttributeConstants}();MscrmCommon.AttributeConstants=AttributeConstants})(MscrmCommon||(MscrmCommon={}));var MscrmControls;(function(MscrmControls){var Common;(function(Common){"use strict";(function(ControlState){ControlState[ControlState["Disabled"]=0]="Disabled";ControlState[ControlState["Enabled"]=1]="Enabled"})(Common.ControlState||(Common.ControlState={}));var ControlState=Common.ControlState})(Common=MscrmControls.Common||(MscrmControls.Common={}))})(MscrmControls||(MscrmControls={}));var MscrmCommon;(function(MscrmCommon){"use strict";var CommonControl=function(){function CommonControl(){this.lastKeyPress=true;this.isInitialized=false;this.isEnabled=false;this.shouldPreventMultipleEventTypes=true;this.isInReadMode=true;this.updateEvents=new Mscrm.UpdateEvents}Object.defineProperty(CommonControl.prototype,"isControlInitialized",{"get":function(){return this.isInitialized},"set":function(value){},enumerable:true,configurable:true});CommonControl.prototype.init=function(context,notifyOutputChanged,state,container){MscrmCommon.ControlUtils.Object.isNullOrUndefined(container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.NullOrUndefinedInitContainer);MscrmCommon.ControlUtils.Object.isNullOrUndefined(notifyOutputChanged)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.NullOrUndefinedInitNotifyOutputChangedDelegate);if(this.isControlInitialized)return;this.container=container;this.notifyOutputChanged=notifyOutputChanged;this.disablePanoramaScroll=context.utils.disablePanoramaScroll.bind(context.utils);this.initializeControl(context,state)};CommonControl.prototype.updateView=function(context){if(this.shouldIgnoreUpdate(context))return;this.throwIfPropertyBagNotValid(context);!this.isInitialized&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.UninitializedErrorMessage);this.handleEditToReadModeTransition(context);this.isEnabled=this.isControlEnabled(context);this.updateCore(context);if(context.mode.isRead||context.mode.isPreview)this.renderReadMode(context);else this.renderEditMode(context)};CommonControl.prototype.getOutputs=function(){!this.isControlInitialized&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.UninitializedControl);return this.getOutputsCore()};CommonControl.prototype.onPreNavigation=function(){return};CommonControl.prototype.destroy=function(){if(this.isControlInitialized){this.eventGuard.destroy();this.destroyCore()}this.cleanup()};CommonControl.prototype.createWrapperContainer=function(className,isRtl){if(className===void 0)className="";if(isRtl===void 0)isRtl=false;var wrapperContainer=document.createElement("div");wrapperContainer.className=MscrmCommon.CommonControl.ClassName;wrapperContainer.className+=className===""?"":" "+className;MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.CommonControl.NullOrUndefinedInitContainer);if(isRtl)wrapperContainer.className+=" "+MscrmCommon.CommonControl.ClassRtl;this.container.appendChild(wrapperContainer);return wrapperContainer};CommonControl.prototype.initCore=function(context,state){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"initCore"))};CommonControl.prototype.updateCore=function(context){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"updateCore"))};CommonControl.prototype.destroyCore=function(){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"destroyCore"))};CommonControl.prototype.renderReadMode=function(context){this.shouldNotifyOutputChanged=false};CommonControl.prototype.renderEditMode=function(context){this.shouldNotifyOutputChanged=false;if(this.isInReadMode){if(this.preventEditModePanoramaEvents){this.removePanoramaEventsHandlers();this.addPanoramaEventsHandlers()}this.eventGuard.preventClicksUntilUserInteracted()}this.isInReadMode=false};CommonControl.prototype.getOutputsCore=function(){MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(CommonControl.MethodNotOverridenFormat,"getOutputsCore"));return null};CommonControl.prototype.notifyEnabledControlOutputChanged=function(){if(this.isEnabled)this.shouldNotifyOutputChanged&&this.notifyOutputChanged()};CommonControl.prototype.isControlEnabled=function(context){return !context.mode.isRead&&!context.mode.isPreview&&!context.mode.isControlDisabled&&!(context.page&&context.page.isPageReadOnly)};CommonControl.prototype.showDefaultLabelCore=function(context){return false};CommonControl.prototype.toggleContainerVisibility=function(value){if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.controlWrapperContainer))value?$(this.container).show():$(this.container).hide();else value?$(this.controlWrapperContainer).show():$(this.controlWrapperContainer).hide()};CommonControl.prototype.initializeControl=function(context,state){try{this.throwIfPropertyBagNotValid(context);this.notificationHandler=new MscrmCommon.ErrorHandling.NotificationHandler(context.utils.setNotification.bind(context.utils),context.utils.clearNotification.bind(context.utils));this.htmlEncode=context.utils.crmHtmlEncode.bind(context.utils);this.eventGuard=new MscrmCommon.EventGuard(this.container,context.client.userAgent);this.initCore(context,state);this.shouldPreventMultipleEventTypes&&this.eventGuard.preventMultipleEventTypes();this.isEnabled=this.isControlEnabled(context);this.isInitialized=true}catch(e){if(this.container.hasChildNodes())for(var childCount=this.container.childNodes.length,i=childCount-1;i>=0;i--)this.container.removeChild(this.container.childNodes[i]);MscrmCommon.ErrorHandling.ExceptionHandler.throwException(e)}};CommonControl.prototype.shouldIgnoreUpdate=function(context){var shouldIgnore=true;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(context)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.updatedProperties)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.updateEvents)||context.updatedProperties.length==0)return false;for(var i=0;i<context.updatedProperties.length;i++){var eventType=Mscrm.UpdateEvents.getEventType(context.updatedProperties[i]);shouldIgnore=shouldIgnore&&this.updateEvents.isIgnoredEvent(eventType)}return shouldIgnore};CommonControl.prototype.throwIfPropertyBagNotValid=function(context){MscrmCommon.ControlUtils.Object.isNullOrUndefined(context)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(CommonControl.UninitializedDataBagMessage);MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.parameters)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.parameters"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.setNotification)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.setNotification"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.clearNotification)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.clearNotification"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.openInBrowser)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.openInBrowser"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.getServiceUri)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.getServiceUri"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.mode)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(!this.isControlEnabled(context))&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode.isControlDisabled"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.mode.isRead)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode.isRead"));MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.mode.isPreview)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.mode.isPreview"));if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils");if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(context.utils.crmHtmlEncode))throw MscrmCommon.ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"dataBag.utils.crmHtmlEncode")};CommonControl.prototype.cleanup=function(){if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.container)){MscrmCommon.ThemingHelper.removeStyles(this.container);this.preventEditModePanoramaEvents&&this.removePanoramaEventsHandlers()}this.isInitialized=false;this.notifyOutputChanged=null;$(this.container).empty();this.container=null};CommonControl.prototype.handleEditToReadModeTransition=function(context){if(!this.isInReadMode&&context.mode.isRead){this.preventEditModePanoramaEvents&&this.removePanoramaEventsHandlers();this.eventGuard.stopPreventingClicks();this.isInReadMode=true}};CommonControl.prototype.removePanoramaEventsHandlers=function(){$(this.container).off(CommonControl.PointerDownEventName);$(this.container).off(CommonControl.PointerMoveEventName);$(this.container).off(CommonControl.PointerUpEventName);$(this.container).off(CommonControl.TouchEndEventName)};CommonControl.prototype.addPanoramaEventsHandlers=function(){var _this=this;$(this.container).on(CommonControl.PointerDownEventName,function(event){if(_this.isEnabled){_this.disablePanoramaScroll(true);event.stopPropagation()}});$(this.container).on(CommonControl.PointerMoveEventName,function(event){_this.isEnabled&&event.stopPropagation()});$(this.container).on(CommonControl.PointerUpEventName,function(event){_this.isEnabled&&_this.disablePanoramaScroll(false)});$(this.container).on(CommonControl.TouchEndEventName,function(event){_this.isEnabled&&_this.disablePanoramaScroll(false)})};CommonControl.prototype.bindFocusVisibility=function(focusElement,container){var _this=this;focusElement.on("focus",function(){_this.lastKeyPress&&container.addClass(CommonControl.accessibilityOutlineClassName)});focusElement.on("focusout",function(){container.removeClass(CommonControl.accessibilityOutlineClassName)});container.on("mousedown touchstart",function(){_this.lastKeyPress=false;container.removeClass(CommonControl.accessibilityOutlineClassName)});container.on("keydown",function(){_this.lastKeyPress=true})};CommonControl.prototype.unbindFocusVisibility=function(focusElement,container){focusElement.off("focus");focusElement.off("focusout");container.off("mousedown");container.off("touchstart");container.off("keydown")};CommonControl.ClassName="mocaControls";CommonControl.ClassRtl="rtl";CommonControl.PointerDownEventName="pointerdown.CustomControl";CommonControl.PointerMoveEventName="pointermove.CustomControl";CommonControl.PointerUpEventName="pointerup.CustomControl";CommonControl.TouchEndEventName="touchend.CustomControl";CommonControl.DefaultValueLabel="---";CommonControl.NullOrUndefinedInitContainer="Null or undefined control container.";CommonControl.NullOrUndefinedInitValueContainer="Null or undefined control value container.";CommonControl.NullOrUndefinedInitNotifyOutputChangedDelegate="Null or undefined NotifyOutputChanged delegate.";CommonControl.UninitializedErrorMessage="init should be called before calling update.";CommonControl.UninitializedDataBagMessage="Null or undefined dataBag property.";CommonControl.InvalidDataBagKeyFormat="Expected key {0} in the input data bag.";CommonControl.UninitializedControl="Control is used uninitialized.";CommonControl.InvalidInputParamMinMax="Min and max values do not bound a valid interval.";CommonControl.InvalidInputParamStep="Step parameter should be greater than 0 and less than the interval bound by min and max.";CommonControl.InvalidInputParamValue="Value for the control is not within the desired interval.";CommonControl.NotGreaterThanZeroInputParamValue="Parameter {0} should be greater than zero.";CommonControl.InvalidInputParam="One or more of the input parameters are invalid: {0}";CommonControl.MethodNotOverridenFormat="Method {0} is not overridden in the specialized class.";CommonControl.MethodNotImplementedInControl="Method {0} is not implemented in the control.";CommonControl.accessibilityOutlineClassName="outline-for-accessibility";return CommonControl}();MscrmCommon.CommonControl=CommonControl})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var FieldControlBase=function(_super){__extends(FieldControlBase,_super);function FieldControlBase(){_super.call(this);this.updateEvents.shouldIgnoreEvent(Mscrm.UpdateEventType.Layout,true);this.updateEvents.shouldIgnoreEvent(Mscrm.UpdateEventType.Activation,true)}return FieldControlBase}(MscrmCommon.CommonControl);MscrmCommon.FieldControlBase=FieldControlBase})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var EventConstants=function(){function EventConstants(){}EventConstants.Change="change";EventConstants.Click="click";EventConstants.JQueryKnobConfigure="configure";EventConstants.JQuerySwipeLeft="swipeleft";EventConstants.JQuerySwipeRight="swiperight";EventConstants.KeyUp="keyup";EventConstants.KeyDown="keydown";EventConstants.MouseUp="mouseup";EventConstants.MouseDown="mousedown";EventConstants.MouseOver="mouseover";EventConstants.MouseMove="mousemove";EventConstants.MouseOut="mouseout";EventConstants.PointerDown="pointerdown";EventConstants.PointerMove="pointermove";EventConstants.PointerUp="pointerup";EventConstants.PointerOut="pointerout";EventConstants.MSPointerOver="MSPointerOver";EventConstants.MSPointerDown="MSPointerDown";EventConstants.MSPointerOut="MSPointerOut";EventConstants.MSPointerUp="MSPointerUp";EventConstants.MSPointerMove="MSPointerMove";EventConstants.TouchStart="touchstart";EventConstants.TouchMove="touchmove";EventConstants.TouchEnd="touchend";EventConstants.WijmoValueChangedEvent="valueChanged";EventConstants.WijmoIsDroppedDownChangedEvent="isDroppedDownChanged";EventConstants.WijmoSelectedIndexChangedEvent="selectedIndexChanged";EventConstants.VMouseMove="vmousemove";EventConstants.Focus="focus";EventConstants.FocusIn="focusin";EventConstants.FocusOut="focusout";EventConstants.FocusEvents="focusin focusout";return EventConstants}();MscrmCommon.EventConstants=EventConstants})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var EventGuard=function(){function EventGuard(container,userAgent){this.container=container;this.userAgent=userAgent}EventGuard.prototype.destroy=function(){this.stopPreventingClicks();this.stopPreventingFocus();this.stopPreventingMultipleEventTypes();this.container=null;this.userAgent=null};EventGuard.prototype.preventClicksUntilUserInteracted=function(){var _this=this;if(this.container==null||this.userAgent==null)return;this.stopPreventingClicks();$(this.container).on(EventGuard.hasUserInteractedEventName,function(e){_this.userInteractedInEditMode=true});this.removeClickEventHandler=EventGuard.handleEditModeClickEvents(this.container,this)};EventGuard.prototype.stopPreventingClicks=function(){this.userInteractedInEditMode=false;$(this.container).off(EventGuard.hasUserInteractedEventName);!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.removeClickEventHandler)&&this.removeClickEventHandler();this.removeClickEventHandler=null};EventGuard.prototype.preventEditModeTransitionFocus=function(){var _this=this;if(this.container==null||this.userAgent==null)return;this.stopPreventingFocus();this.userInteractedInEditModeWithAnInputElement=false;var inputElements=$(this.container).find("input");inputElements.each(function(index,element){element.setAttribute(MscrmCommon.AttributeConstants.ReadOnly,MscrmCommon.AttributeConstants.ReadOnly);_this.userAgent.isAndroid&&$(element).on(EventGuard.focusRemoveEvent,function(e){$(element).blur();$(element).off(EventGuard.focusRemoveEvent)});$(element).on(EventGuard.hasUserInteractedWithElementEventName,function(e){_this.stopPreventingFocusEvents(element)})})};EventGuard.prototype.stopPreventingFocus=function(){var _this=this;if(!this.userInteractedInEditModeWithAnInputElement){var inputElements=$(this.container).find("input");inputElements.each(function(index,element){_this.stopPreventingFocusEvents(element)})}};EventGuard.prototype.preventMultipleEventTypes=function(){var _this=this;if(this.container==null||this.userAgent==null)return;var resetMultipleEventTypeFlags=function(e){_this.shouldPreventMouseEvents=false;_this.shouldPreventTouchEvents=false},removeTouchEventHandlers=EventGuard.preventTouchEventsAfterMouseDown(this.container,this),removeMouseEventHandlers=EventGuard.preventMouseEventsAfterTouchStart(this.container,this);this.container.addEventListener(MscrmCommon.EventConstants.Click,resetMultipleEventTypeFlags,true);var removalCallback=function(){removeTouchEventHandlers();removeMouseEventHandlers();_this.container.removeEventListener(MscrmCommon.EventConstants.Click,resetMultipleEventTypeFlags,true)};this.removeMultipleEventHandlers=removalCallback};EventGuard.prototype.stopPreventingMultipleEventTypes=function(){!MscrmCommon.ControlUtils.Object.isNullOrUndefined(this.removeMultipleEventHandlers)&&this.removeMultipleEventHandlers();this.removeMultipleEventHandlers=null};EventGuard.prototype.stopPreventingFocusEvents=function(element){element.removeAttribute(MscrmCommon.AttributeConstants.ReadOnly);this.userAgent.isAndroid&&$(element).off(EventGuard.focusRemoveEvent);$(element).off(EventGuard.hasUserInteractedWithElementEventName);this.userInteractedInEditModeWithAnInputElement=true};EventGuard.handleEditModeClickEvents=function(element,eventGuard){var preventFirstClick=function(e){if(!eventGuard.userInteractedInEditMode){e.stopPropagation();eventGuard.userInteractedInEditMode=true;$(element).trigger(MscrmCommon.EventConstants.Click)}eventGuard.userInteractedInEditMode=true};element.addEventListener(MscrmCommon.EventConstants.Click,preventFirstClick,true);return function(){element.removeEventListener(MscrmCommon.EventConstants.Click,preventFirstClick,true)}};EventGuard.preventTouchEventsAfterMouseDown=function(element,eventGuard){var onTouchStart=function(e){if(!eventGuard.shouldPreventTouchEvents)eventGuard.shouldPreventMouseEvents=true;else e.stopImmediatePropagation()},preventTouchEventsIfRequired=function(e){eventGuard.shouldPreventTouchEvents&&e.stopImmediatePropagation()};element.addEventListener(MscrmCommon.EventConstants.TouchStart,onTouchStart,true);element.addEventListener(MscrmCommon.EventConstants.TouchMove,preventTouchEventsIfRequired,true);element.addEventListener(MscrmCommon.EventConstants.TouchEnd,preventTouchEventsIfRequired,true);return function(){element.removeEventListener(MscrmCommon.EventConstants.TouchStart,onTouchStart,true);element.removeEventListener(MscrmCommon.EventConstants.TouchMove,preventTouchEventsIfRequired,true);element.removeEventListener(MscrmCommon.EventConstants.TouchEnd,preventTouchEventsIfRequired,true)}};EventGuard.preventMouseEventsAfterTouchStart=function(element,eventGuard){var onMouseDown=function(e){if(!eventGuard.shouldPreventMouseEvents)eventGuard.shouldPreventTouchEvents=true;else e.stopImmediatePropagation()},preventMouseEventsIfRequired=function(e){eventGuard.shouldPreventMouseEvents&&e.stopImmediatePropagation()};element.addEventListener(MscrmCommon.EventConstants.MouseDown,onMouseDown,true);element.addEventListener(MscrmCommon.EventConstants.MouseMove,preventMouseEventsIfRequired,true);element.addEventListener(MscrmCommon.EventConstants.MouseUp,preventMouseEventsIfRequired,true);return function(){element.removeEventListener(MscrmCommon.EventConstants.MouseDown,onMouseDown,true);element.removeEventListener(MscrmCommon.EventConstants.MouseMove,preventMouseEventsIfRequired,true);element.removeEventListener(MscrmCommon.EventConstants.MouseUp,preventMouseEventsIfRequired,true)}};EventGuard.focusRemoveEvent="focus.RemoveFocus";EventGuard.hasUserInteractedEventName="pointerdown.UserInteracted";EventGuard.hasUserInteractedWithElementEventName="pointerdown.UserInteractedElement";return EventGuard}();MscrmCommon.EventGuard=EventGuard})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var MethodConstants=function(){function MethodConstants(){}MethodConstants.Destroy="destroy";MethodConstants.Refresh="refresh";MethodConstants.Value="value";MethodConstants.Option="option";MethodConstants.Disable="disable";MethodConstants.Enable="enable";return MethodConstants}();MscrmCommon.MethodConstants=MethodConstants})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var ControlGuidGenerator=function(){function ControlGuidGenerator(){}ControlGuidGenerator.newGuid=function(controlName){return controlName+"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})};return ControlGuidGenerator}();ControlUtils.ControlGuidGenerator=ControlGuidGenerator})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var Enum=function(){function Enum(){}Enum.getFromString=function(enumArray,stringValue){for(var i in enumArray)if(enumArray[i]==stringValue)return parseInt(i);return -1};return Enum}();ControlUtils.Enum=Enum})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var Event=function(){function Event(){}Event.createName=function(eventName,eventNamespace){return ControlUtils.String.Format("{0}.{1}",eventName,eventNamespace)};return Event}();ControlUtils.Event=Event})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var HitTarget=function(){function HitTarget(){}HitTarget.exists=function(container,hitTargetClassSelector){return container.find(hitTargetClassSelector).length>0};HitTarget.create=function(container,controlDomElement,hitTargetClass,trackElementClassSelector,paddingLeftPx,min,max,setControlValue){max<min&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException("Expected max to be bigger then min");controlDomElement.wrap('<div class="'+hitTargetClass+'"/>');var controlNumericRange=max-min,hitTargetElement=container.find("."+hitTargetClass),setValue=function(event){var offset=container.find(trackElementClassSelector).offset(),width=controlDomElement.width(),height=controlDomElement.height(),isClickOutsideControlHeight=event.pageY<offset.top||event.pageY>offset.top+height;if(!isClickOutsideControlHeight)return;var isClickInsideContainer=$(event.target).hasClass(controlDomElement[0].className)||$(event.target).hasClass(hitTargetClass);if(!isClickInsideContainer)return;var xAxisDisplacementPercent=Math.abs(event.pageX+paddingLeftPx-offset.left)/width;if(xAxisDisplacementPercent<=1){var newValue=ControlUtils.NumericInterval.trunc(min+controlNumericRange*xAxisDisplacementPercent);setControlValue(newValue)}if(event.type===MscrmCommon.EventConstants.PointerDown){$(document).on(HitTarget.mouseUpHitTargetEventName,function(e){HitTarget.removeHitTargetSubsequentEvents(hitTargetElement)});hitTargetElement.on(HitTarget.subsequentEvents,setValue)}else event.type===MscrmCommon.EventConstants.PointerUp&&HitTarget.removeHitTargetSubsequentEvents(hitTargetElement)};hitTargetElement.on(HitTarget.initialEvents,setValue);hitTargetElement.on(MscrmCommon.EventConstants.TouchEnd,function(event){HitTarget.removeHitTargetSubsequentEvents(hitTargetElement)})};HitTarget.removeHitTargetSubsequentEvents=function(hitTargetElement){$(document).off(HitTarget.mouseUpHitTargetEventName);hitTargetElement.off(HitTarget.subsequentEvents)};HitTarget.initialEvents="click pointerdown";HitTarget.subsequentEvents="pointermove pointerup";HitTarget.mouseUpHitTargetEventName="mouseup.HitTarget";return HitTarget}();ControlUtils.HitTarget=HitTarget})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var NumericInterval=function(){function NumericInterval(){}NumericInterval.provideDefaultValuesIfNullDataBagParameters=function(context,hasStep){if(hasStep===void 0)hasStep=true;if(hasStep&&ControlUtils.Object.isNullOrUndefined(context.parameters.step))context.parameters.step={raw:0};if(ControlUtils.Object.isNullOrUndefined(context.parameters.min))context.parameters.min={raw:0};if(ControlUtils.Object.isNullOrUndefined(context.parameters.max))context.parameters.max={raw:0}};NumericInterval.throwIfNullDataBagParameters=function(context,hasStep){if(hasStep===void 0)hasStep=true;ControlUtils.Object.isNullOrUndefined(context.parameters.value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value"));ControlUtils.Object.isNullOrUndefined(context.parameters.value.attributes.MinValue)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.MinValue"));ControlUtils.Object.isNullOrUndefined(context.parameters.value.attributes.MaxValue)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"value.attributes.MaxValue"));hasStep&&ControlUtils.Object.isNullOrUndefined(context.parameters.step)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"step"));ControlUtils.Object.isNullOrUndefined(context.parameters.min)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"min"));ControlUtils.Object.isNullOrUndefined(context.parameters.max)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ControlUtils.String.Format(MscrmCommon.CommonControl.InvalidDataBagKeyFormat,"max"))};NumericInterval.processPropertyBagValues=function(context,notificationHandler,roundValues){if(roundValues===void 0)roundValues=true;ControlUtils.Object.isNullOrUndefined(context.parameters)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException("Expected context.parameters object");var min=context.parameters.min,max=context.parameters.max,value=context.parameters.value,step=context.parameters.step,hasStep=!ControlUtils.Object.isNullOrUndefined(step);ControlUtils.Object.isNullOrUndefined(notificationHandler)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException("Expected notificationHandler object");notificationHandler.clear(MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId);if(ControlUtils.Object.isNullOrUndefined(min.raw))min.raw=context.parameters.value.attributes.MinValue;if(ControlUtils.Object.isNullOrUndefined(max.raw))max.raw=context.parameters.value.attributes.MaxValue;if(max.raw<min.raw){var swap=max.raw;max.raw=min.raw;min.raw=swap}if(ControlUtils.Object.isNullOrUndefined(value.raw)||value.error==true)value.raw=min.raw;if(hasStep&&ControlUtils.Object.isNullOrUndefined(step.raw))step.raw=NumericInterval.StepDefaultValue;if(roundValues){min.raw=Math.round(min.raw);max.raw=Math.round(max.raw);value.raw=Math.round(value.raw);if(hasStep)step.raw=Math.round(step.raw)}if(hasStep&&(step.raw>max.raw-min.raw||step.raw<=0||value.raw%step.raw!==0))step.raw=NumericInterval.StepDefaultValue;if(value.raw<min.raw||value.raw>max.raw){var messageFormat=context.resources.getString(MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId),message=ControlUtils.String.Format(messageFormat,min.raw,max.raw);notificationHandler.notify(message,MscrmCommon.ErrorHandling.ErrorCode.ValueOutOfRangeId)}};NumericInterval.createOptionalNumberPropery=function(value){return {raw:value,type:"Optional",error:null,attributes:null,errorMessage:null}};NumericInterval.moveValueToMultipleOfStep=function(value,context){if(Math.abs(value-context.parameters.min.raw)%context.parameters.step.raw!==0&&value!==context.parameters.max.raw){var stepsAfterMinimum=Math.floor(Math.abs(value-context.parameters.min.raw)/context.parameters.step.raw);if(isNaN(stepsAfterMinimum))stepsAfterMinimum=0;value=context.parameters.min.raw+stepsAfterMinimum*context.parameters.step.raw;if(value>context.parameters.max.raw)value=context.parameters.max.raw}return value};NumericInterval.getFormattedValue=function(value){var formattedValue=value.formatted;if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(formattedValue)||MscrmCommon.ControlUtils.String.isNullOrWhitespace(formattedValue)){var rawValue=value.raw;formattedValue=!MscrmCommon.ControlUtils.Object.isNullOrUndefined(rawValue)?rawValue.toString():MscrmCommon.ControlUtils.String.Empty}return formattedValue};NumericInterval.isPercent=function(formattedValue){return !MscrmCommon.ControlUtils.Object.isNullOrUndefined(formattedValue)&&formattedValue.indexOf("%")>-1};NumericInterval.setValueContainer=function(container,value){var jqueryContainer=$(container);jqueryContainer.show();jqueryContainer.text(value)};NumericInterval.getPrecision=function(property){return property.attributes.Precision};NumericInterval.isNumber=function(value){return !MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&typeof value=="number"};NumericInterval.trunc=function(x){return x<0?Math.ceil(x):Math.floor(x)};NumericInterval.isNumeric=function(value){return !isNaN(value)&&isFinite(value)};NumericInterval.StepDefaultValue=1;return NumericInterval}();ControlUtils.NumericInterval=NumericInterval})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var WijmoGlobalization=function(){function WijmoGlobalization(){}WijmoGlobalization.setCrmNumberFormatting=function(crmFormatting){WijmoGlobalization.formatting=crmFormatting;if(!WijmoGlobalization.wijmoFormatNumber){WijmoGlobalization.wijmoFormatNumber=wijmo.Globalize.formatNumber;wijmo.Globalize.formatNumber=WijmoGlobalization.formatNumber}};WijmoGlobalization.formatNumber=function(value,format,trim){var matches=format.match(/\d+/),prec=matches?parseInt(matches[0]):null;switch(format[0]){case "N":return WijmoGlobalization.formatting.formatDecimal(value,prec);case "C":return WijmoGlobalization.formatting.formatCurrency(value,prec);default:return WijmoGlobalization.wijmoFormatNumber(value,format,trim)}};WijmoGlobalization.getFormat=function(context){var numberFormattingInfo=context.client.numberFormattingInfo,formattedValue=MscrmCommon.ControlUtils.NumericInterval.getFormattedValue(context.parameters.value),crmNumberType=context.parameters.value.attributes.Type,isPercent=MscrmCommon.ControlUtils.NumericInterval.isPercent(formattedValue),overriddenPrecision=MscrmCommon.ControlUtils.NumericInterval.getPrecision(context.parameters.value);WijmoGlobalization.setWijmoNumberFormatStructure(numberFormattingInfo,crmNumberType,isPercent,overriddenPrecision);var valueFormat=MscrmCommon.Globalization.WijmoNumberFormatFactory.getNumberFormatString(numberFormattingInfo,crmNumberType,isPercent,overriddenPrecision);return valueFormat};WijmoGlobalization.getFormattedValue=function(value,format){return wijmo.Globalize.format(value,format)};WijmoGlobalization.setWijmoNumberFormatStructure=function(crmNumberFormat,numberType,isPercent,overriddenPrecision){var wijmoNumberFormat=MscrmCommon.Globalization.WijmoNumberFormatFactory.getWijmoNumberFormatStructure(crmNumberFormat,numberType,isPercent,overriddenPrecision);if(MscrmCommon.ControlUtils.Object.isNullOrUndefined(wijmo.culture)){wijmo.culture={Globalize:{numberFormat:wijmoNumberFormat}};return}wijmo.culture.Globalize.numberFormat=wijmoNumberFormat};return WijmoGlobalization}();ControlUtils.WijmoGlobalization=WijmoGlobalization})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var Object=function(){function Object(){}Object.isNullOrUndefined=function(object){return typeof object=="undefined"||object==null};return Object}();ControlUtils.Object=Object})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var Property=function(){function Property(){}Property.isNullOrEmpty=function(property){return MscrmCommon.ControlUtils.Object.isNullOrUndefined(property)||MscrmCommon.ControlUtils.Object.isNullOrUndefined(property.raw)||MscrmCommon.ControlUtils.String.isNullOrEmpty(property.raw)};return Property}();ControlUtils.Property=Property})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var ControlUtils;(function(ControlUtils){"use strict";var String=function(){function String(){}String.isNullOrEmpty=function(s){return s==null||s.length===0};String.isNullOrWhitespace=function(s){return s==null||s.trim().length===0};String.isNullUndefinedOrWhitespace=function(s){return s==null||s==undefined||s.trim().length===0};String.Format=function(format){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];for(var returnValue=format,i=1;i<arguments.length;i++){var actualValue=typeof arguments[i]=="undefined"||arguments[i]==null?"":arguments[i].toString();returnValue=returnValue.replace(new RegExp("\\{"+(i-1)+"\\}","g"),actualValue)}return returnValue};String.EqualsIgnoreCase=function(string1,string2){var isString1Null=string1==null,isString2Null=string2==null,isString1Undefined=string1==undefined,isString2Undefined=string2==undefined;if(isString1Null&&isString2Null||isString1Undefined&&isString2Undefined)return true;if(isString1Null!=isString2Null||isString1Undefined!=isString2Undefined)return false;return string1.toUpperCase()===string2.toUpperCase()};String.ReplaceLineBreaksWithBrTags=function(text){return text.replace(/(?:\r\n|&#13;&#10;|\r|&#13;|\n|&#10;)/g,"<br />")};String.Empty="";return String}();ControlUtils.String=String})(ControlUtils=MscrmCommon.ControlUtils||(MscrmCommon.ControlUtils={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var SizeMode;(function(SizeMode){SizeMode[SizeMode["Fullmode"]=0]="Fullmode";SizeMode[SizeMode["Sbreakpoint"]=1]="Sbreakpoint";SizeMode[SizeMode["Mbreakpoint"]=2]="Mbreakpoint"})(SizeMode||(SizeMode={}));var CellScope;(function(CellScope){CellScope[CellScope["Header"]=0]="Header";CellScope[CellScope["EditForm"]=1]="EditForm";CellScope[CellScope["Footer"]=2]="Footer"})(CellScope||(CellScope={}));var ThemingHelper=function(){function ThemingHelper(){}ThemingHelper.injectStyle=function(container,css){MscrmCommon.ControlUtils.Object.isNullOrUndefined(container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidContainerMessage);MscrmCommon.ControlUtils.Object.isNullOrUndefined(css)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssMessage);var styleElements=container.getElementsByTagName("style"),styleTag=null;if(styleElements.length===0){styleTag=document.createElement("style");container.appendChild(styleTag)}else styleTag=styleElements.item(0);styleTag.innerHTML=css};ThemingHelper.removeStyles=function(container){MscrmCommon.ControlUtils.Object.isNullOrUndefined(container)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidContainerMessage);for(var styles=container.getElementsByTagName("style"),stylesCount=styles.length,i=stylesCount-1;i>=0;i--)container.removeChild(styles.item(i))};ThemingHelper.getProcessNonSelectedColor=function(theming){return "#6F6F6F"};ThemingHelper.getGlobalLinkColor=function(theming){return ThemingHelper.validateCssColor(theming.colors.globallink)};ThemingHelper.getHoverLinkColor=function(theming){var hoverlinkeffectcolor=theming.hoverlinkeffect;if(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(theming.colors)&&!MscrmCommon.ControlUtils.Object.isNullOrUndefined(theming.colors.hoverlinkeffect))hoverlinkeffectcolor=theming.colors.hoverlinkeffect;return ThemingHelper.validateCssColor(hoverlinkeffectcolor)};ThemingHelper.getProcessControlColor=function(theming){return ThemingHelper.validateCssColor(theming.colors.processcontrol)};ThemingHelper.getShadeControlColor=function(theming){return ThemingHelper.validateCssColor(theming.colors.controlshade)};ThemingHelper.getFontFamily=function(theming){return ThemingHelper.validateCssFontFamily(theming.normalfontfamily)};ThemingHelper.getFontColor=function(theming){return ThemingHelper.validateCssColor(theming.normalfontcolor)};ThemingHelper.getFontSize=function(theming){return ThemingHelper.validateCssSize(theming.normalfontsize)};ThemingHelper.validateCssColor=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);var hexMatch=value.match(/^#[0-9a-fA-F]{6}$/),rgbMatch=value.match(/^rgb\(\d{1,3}%?, ?\d{1,3}%?, ?\d{1,3}%?\)$/),rgbaMatch=value.match(/^rgba\(\d{1,3}%?, ?\d{1,3}%?, ?\d{1,3}%?, ?[0-1]?.[0-9]\)$/),hslMatch=value.match(/^hsl\(\d{1,3}, ?\d{1,3}%, ?\d{1,3}%\)$/),hslaMatch=value.match(/^hsla\(\d{1,3}, ?\d{1,3}%, ?\d{1,3}%, ?[0-1]?.[0-9]\)$/),nameMatch=value.match(/^[a-zA-Z]+$/);if(hexMatch&&hexMatch.length===1||rgbMatch&&rgbMatch.length===1||rgbaMatch&&rgbaMatch.length===1||hslMatch&&hslMatch.length===1||hslaMatch&&hslaMatch.length===1||nameMatch&&nameMatch.length===1)return value;MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage)};ThemingHelper.validateCssFontFamily=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);var fontMatch=value.match(/^[a-zA-Z\-\"\', ]+$/);(!fontMatch||fontMatch.length!==1)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);return value};ThemingHelper.validateCssSize=function(value){MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);var sizeMatch=value.match(/^\d+[%a-z]+$/);(!sizeMatch||sizeMatch.length!==1)&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(ThemingHelper.InvalidCssValueMessage);return value};ThemingHelper.isHeaderCell=function(scope){return scope&&scope.raw===CellScope.Header};ThemingHelper.getEditModeStyle=function(theming,scope,deviceSizeMode,error){var colors=theming.colors,measures=theming.measures,fontsizes=theming.fontsizes,solidborderstyle=theming.solidborderstyle,textbox=theming.textbox,borderWidth=error?textbox.errorlinethickness:textbox.linethickness;return {width:"100%",boxSizing:"border-box",lineHeight:textbox.lineheight,fontWeight:error?textbox.contentfontweight:textbox.fontweight,fontSize:ThemingHelper.isHeaderCell(scope)?fontsizes.font125:fontsizes.font100,color:error?textbox.redcolor:textbox.contentcolor,paddingLeft:textbox.horizontalpadding,paddingRight:textbox.horizontalpadding,paddingTop:textbox.verticalpadding,paddingBottom:textbox.verticalpadding,backgroundColor:error?textbox.errorbackgroundcolor:textbox.backgroundcolor,borderColor:error?textbox.redcolor:colors.grays.gray05,borderStyle:solidborderstyle,borderLeftWidth:borderWidth,borderRightWidth:borderWidth,borderBottomWidth:borderWidth,borderTopWidth:borderWidth}};ThemingHelper.getReadModeStyle=function(theming,scope,deviceSizeMode,error,isControlDisabled){var measures=theming.measures,fontsizes=theming.fontsizes,solidborderstyle=theming.solidborderstyle,textbox=theming.textbox,readModeStyle={width:"100%",lineHeight:textbox.lineheight,fontWeight:textbox.contentfontweight,fontSize:ThemingHelper.isHeaderCell(scope)?fontsizes.font125:fontsizes.font100,color:error?textbox.redcolor:textbox.contentcolor,borderColor:textbox.restmodecolor,borderStyle:solidborderstyle,borderWidth:textbox.linethickness,paddingLeft:textbox.horizontalpadding,paddingRight:textbox.horizontalpadding,paddingTop:textbox.verticalpadding,paddingBottom:textbox.verticalpadding};return isControlDisabled?Object.assign(readModeStyle,ThemingHelper.getDisableStyle(theming)):readModeStyle};ThemingHelper.getDisableStyle=function(theming){return {backgroundColor:theming.colors.grays.gray02,border:"none",color:theming.colors.grays.gray07,cursor:"default",fontSize:theming.fontsizes.font100,fontFamily:theming.fontfamilies.regular,textDecoration:"none"}};ThemingHelper.convertHexColorToRGBA=function(hex,opacity){var c;c=hex.substring(1).split("");if(c.length==3)c=[c[0],c[0],c[1],c[1],c[2],c[2]];var hexString="0x"+c.join("");return "rgba("+[hexString>>16&255,hexString>>8&255,hexString&255].join(",")+","+opacity+")"};ThemingHelper.InvalidContainerMessage="The supplied container is null or undefined.";ThemingHelper.InvalidCssMessage="The supplied CSS is null or undefined.";ThemingHelper.InvalidCssValueMessage="The supplied CSS value is not valid.";ThemingHelper.ReadModeClassName="readmode";ThemingHelper.EditModeClassName="editmode";return ThemingHelper}();MscrmCommon.ThemingHelper=ThemingHelper})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var FullscreenHelper=function(){function FullscreenHelper(){}Object.defineProperty(FullscreenHelper,"supportsFullscreenApi",{"get":function(){var apiTarget=document;return apiTarget.fullscreenEnabled||apiTarget.webkitFullscreenEnabled||apiTarget.mozFullScreenEnabled||apiTarget.msFullscreenEnabled},"set":function(value){},enumerable:true,configurable:true});Object.defineProperty(FullscreenHelper,"fullscreenElement",{"get":function(){var apiTarget=document;return apiTarget.fullscreenElement||apiTarget.webkitFullscreenElement||apiTarget.mozFullScreenElement||apiTarget.msFullscreenElement},"set":function(value){},enumerable:true,configurable:true});FullscreenHelper.requestFullscreen=function(fullscreenTarget){if(fullscreenTarget.requestFullscreen)fullscreenTarget.requestFullscreen();else if(fullscreenTarget.webkitRequestFullscreen)fullscreenTarget.webkitRequestFullscreen();else if(fullscreenTarget.mozRequestFullScreen)fullscreenTarget.mozRequestFullScreen();else fullscreenTarget.msRequestFullscreen&&fullscreenTarget.msRequestFullscreen()};FullscreenHelper.requestFullscreenUsingStyling=function(fullscreenTarget){$(fullscreenTarget).css("width","100vw");$(fullscreenTarget).css("height","100vh");$(fullscreenTarget).css("overflow","visible !important");$(fullscreenTarget).css("position","fixed !important");$(fullscreenTarget).css("top","0px");$(fullscreenTarget).css("left","0px");$(fullscreenTarget).css("background-color","#000000")};FullscreenHelper.exitFullscreen=function(){var apiTarget=document;if(apiTarget.exitFullscreen)apiTarget.exitFullscreen();else if(apiTarget.webkitExitFullscreen)apiTarget.webkitExitFullscreen();else if(apiTarget.mozCancelFullScreen)apiTarget.mozCancelFullScreen();else apiTarget.msExitFullscreen&&apiTarget.msExitFullscreen()};FullscreenHelper.exitFullscreenUsingStyling=function(fullscreenTarget){$(fullscreenTarget).css("width","");$(fullscreenTarget).css("height","");$(fullscreenTarget).css("overflow","");$(fullscreenTarget).css("position","");$(fullscreenTarget).css("top","");$(fullscreenTarget).css("left","");$(fullscreenTarget).css("background-color","")};return FullscreenHelper}();MscrmCommon.FullscreenHelper=FullscreenHelper})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var DataSetColumnSortStatus=function(){function DataSetColumnSortStatus(){}return DataSetColumnSortStatus}();MscrmCommon.DataSetColumnSortStatus=DataSetColumnSortStatus})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var ConditionExpression=function(){function ConditionExpression(){}return ConditionExpression}();MscrmCommon.ConditionExpression=ConditionExpression})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var FilterExpression=function(){function FilterExpression(){}return FilterExpression}();MscrmCommon.FilterExpression=FilterExpression})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var PrimitiveValue=function(){function PrimitiveValue(value,dataType){this.value=value;this.dataType=dataType}return PrimitiveValue}();MscrmCommon.PrimitiveValue=PrimitiveValue})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var Globalization;(function(Globalization){"use strict";var CrmNumberType=function(){function CrmNumberType(){}CrmNumberType.CrmDecimalTypeName="decimal";CrmNumberType.CrmDoubleTypeName="double";CrmNumberType.CrmIntegerTypeName="integer";CrmNumberType.CrmMoneyTypeName="money";return CrmNumberType}();Globalization.CrmNumberType=CrmNumberType})(Globalization=MscrmCommon.Globalization||(MscrmCommon.Globalization={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var Globalization;(function(Globalization){"use strict";var ExceptionHandler=MscrmCommon.ErrorHandling.ExceptionHandler,NumberPatternFactory=function(){function NumberPatternFactory(){this.currencyPositivePatternArray=["$n","n$","$ n","n $"];this.currencyNegativePatternArray=["($n)","-$n","$-n","$n-","(n$)","-n$","n-$","n$-","-n $","-$ n","n $-","$ n-","$ -n","n- $","($ n)","(n $)"];this.percentPositivePatternArray=["n %","n%","%n","% n"];this.percentNegativePatternArray=["-n %","-n%","-%n","%-n","%n-","n-%","n%-","-% n","n %-","% n-","% -n","n- %"]}NumberPatternFactory.prototype.getCurrencyPositivePattern=function(patternValue){return this.getPattern(this.currencyPositivePatternArray,patternValue)};NumberPatternFactory.prototype.getCurrencyNegativePattern=function(patternValue){return this.getPattern(this.currencyNegativePatternArray,patternValue)};NumberPatternFactory.prototype.getPercentPositivePattern=function(patternValue){return this.getPattern(this.percentPositivePatternArray,patternValue)};NumberPatternFactory.prototype.getPercentNegativePattern=function(patternValue){return this.getPattern(this.percentNegativePatternArray,patternValue)};NumberPatternFactory.prototype.getPattern=function(patternArray,patternValue){(patternValue<0||patternValue>=patternArray.length)&&ExceptionHandler.throwException(MscrmCommon.ControlUtils.String.Format(NumberPatternFactory.NoSuchPatternError,patternValue));return patternArray[patternValue]};NumberPatternFactory.NoSuchPatternError="The number formatting pattern value that you specified does not exist: {0}.";return NumberPatternFactory}();Globalization.NumberPatternFactory=NumberPatternFactory})(Globalization=MscrmCommon.Globalization||(MscrmCommon.Globalization={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){var Globalization;(function(Globalization){"use strict";var WijmoNumberFormatFactory=function(){function WijmoNumberFormatFactory(){}WijmoNumberFormatFactory.getWijmoNumberFormatStructure=function(numberFormatInfo,crmNumberType,isPercent,overriddenPrecision){var decimalSeparator=numberFormatInfo.NumberDecimalSeparator,groupSeparator=numberFormatInfo.NumberGroupSeparator;if(crmNumberType.toLowerCase()==Globalization.CrmNumberType.CrmMoneyTypeName){decimalSeparator=numberFormatInfo.CurrencyDecimalSeparator;groupSeparator=numberFormatInfo.CurrencyGroupSeparator}if(isPercent){decimalSeparator=numberFormatInfo.PercentDecimalSeparator;groupSeparator=numberFormatInfo.PercentGroupSeparator}var patternFactory=new Globalization.NumberPatternFactory,percentNegativePattern=patternFactory.getPercentNegativePattern(numberFormatInfo.PercentNegativePattern),percentPositivePattern=patternFactory.getPercentPositivePattern(numberFormatInfo.PercentPositivePattern),currencyNegativePattern=patternFactory.getCurrencyNegativePattern(numberFormatInfo.CurrencyNegativePattern),currencyPositivePattern=patternFactory.getCurrencyPositivePattern(numberFormatInfo.CurrencyPositivePattern);return {".":WijmoNumberFormatFactory.validateSymbolLength(decimalSeparator,1),",":WijmoNumberFormatFactory.validateSymbolLength(groupSeparator,1),percent:{pattern:[percentNegativePattern,percentPositivePattern]},currency:{decimals:!MscrmCommon.ControlUtils.Object.isNullOrUndefined(overriddenPrecision)?overriddenPrecision:numberFormatInfo.CurrencyDecimalDigits,symbol:WijmoNumberFormatFactory.validateSymbolLength(numberFormatInfo.CurrencySymbol,6),pattern:[currencyNegativePattern,currencyPositivePattern]}}};WijmoNumberFormatFactory.getNumberFormatString=function(numberFormatInfo,crmNumberType,isPercent,overriddenPrecision){crmNumberType=crmNumberType.toLowerCase();if(isPercent)return "p"+(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(overriddenPrecision)?overriddenPrecision.toString():numberFormatInfo.PercentDecimalDigits.toString());switch(crmNumberType){case Globalization.CrmNumberType.CrmIntegerTypeName:return "n0";case Globalization.CrmNumberType.CrmMoneyTypeName:return "c";default:return "n"+(!MscrmCommon.ControlUtils.Object.isNullOrUndefined(overriddenPrecision)?overriddenPrecision.toString():numberFormatInfo.NumberDecimalDigits.toString())}};WijmoNumberFormatFactory.validateSymbolLength=function(value,maxLength){!MscrmCommon.ControlUtils.Object.isNullOrUndefined(value)&&value.length>maxLength&&MscrmCommon.ErrorHandling.ExceptionHandler.throwException(WijmoNumberFormatFactory.InvalidSymbolErrorMessage);return value};WijmoNumberFormatFactory.InvalidSymbolErrorMessage="An invalid symbol has been provided by the number formatting information infrastructure.";return WijmoNumberFormatFactory}();Globalization.WijmoNumberFormatFactory=WijmoNumberFormatFactory})(Globalization=MscrmCommon.Globalization||(MscrmCommon.Globalization={}))})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var ArrayQuery=function(){function ArrayQuery(data){this.data=data}ArrayQuery.prototype.select=function(selector){for(var temp=[],i=0;i<this.data.length;i++){var value=selector(this.data[i],i);temp.push(value)}return new ArrayQuery(temp)};ArrayQuery.prototype.transform=function(selector){for(var temp=[],i=0;i<this.data.length;i++){var item=selector(this.data[i],i);temp[item.key]=item.value}return new ArrayQuery(temp)};ArrayQuery.prototype.each=function(delegate){for(var i=0;i<this.data.length;i++)delegate(this.data[i],i);return this};ArrayQuery.prototype.where=function(selector){for(var temp=[],i=0;i<this.data.length;i++)selector(this.data[i])&&temp.push(this.data[i]);return new ArrayQuery(temp)};ArrayQuery.prototype.firstOrDefault=function(selector){var list=this.where(selector).items();if(list.length>0)return list[0];return null};ArrayQuery.prototype.contains=function(selector){return this.firstOrDefault(selector)!=null};ArrayQuery.prototype.items=function(){return this.data};return ArrayQuery}();MscrmCommon.ArrayQuery=ArrayQuery})(MscrmCommon||(MscrmCommon={}));var MscrmCommon;(function(MscrmCommon){"use strict";var DisplayMode=function(){function DisplayMode(){}DisplayMode.UNKNOWN="UNKNOWN";DisplayMode.READ="READ";DisplayMode.EDIT="EDIT";DisplayMode.EDITHINT="EDITHINT";return DisplayMode}();MscrmCommon.DisplayMode=DisplayMode;var ModeSwitchEventName=function(){function ModeSwitchEventName(){}ModeSwitchEventName.fromReadToEdit="FROM_READ_TO_EDIT";return ModeSwitchEventName}();MscrmCommon.ModeSwitchEventName=ModeSwitchEventName;var DisplayModeManager=function(){function DisplayModeManager(ins){this.instance=ins}DisplayModeManager.prototype.getMode=function(){return this.currentMode};DisplayModeManager.prototype.setMode=function(newMode,params){var oldMode=this.currentMode;if(oldMode==null)oldMode=DisplayMode.UNKNOWN;if(oldMode!=newMode){switch(newMode){case DisplayMode.EDIT:switch(oldMode){case DisplayMode.READ:this.instance.context.utils.fireEvent(ModeSwitchEventName.fromReadToEdit,params);this.instance.context.mode.focus();break}break}this.currentMode=newMode}};return DisplayModeManager}();MscrmCommon.DisplayModeManager=DisplayModeManager})(MscrmCommon||(MscrmCommon={}));var Guid=function(){function Guid(value){this._guid=Guid._formatGuidString(value);if(!this.guid)throw new Error(value+" is not a valid Guid value.");Object.freeze(this)}Object.defineProperty(Guid.prototype,"guid",{"get":function(){return this._guid},"set":function(value){},enumerable:true,configurable:true});Guid.toString=function(guid){if(guid)return guid.guid;return null};Guid.prototype.toString=function(){return this.guid};Guid.equals=function(x,y){return Guid.toString(x)===Guid.toString(y)};Guid.tryParse=function(value){return Guid.tryParseOrNull(value)||Guid.EMPTY};Guid.tryParseOrNull=function(value){var parsedValue=Guid._formatGuidString(value);if(parsedValue)return new Guid(parsedValue);else return null};Guid._formatGuidString=function(value){if(!value)return null;value=value.toLowerCase();var hyphenMatch=Guid.braceAndHyphenGuidVerifierPattern.exec(value);if(hyphenMatch){if(hyphenMatch[1].length!==hyphenMatch[8].length)return null;return hyphenMatch[2]}else{var contiguousMatch=Guid.contiguousGuidVerifierPattern.exec(value);if(contiguousMatch)return contiguousMatch.filter(function(_,index){return index>0}).join("-")}return null};Guid.braceAndHyphenGuidVerifierPattern=/^({?)((\d|[a-f]){8}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){4}-(\d|[a-f]){12})(}?)$/;Guid.contiguousGuidVerifierPattern=/^([a-f\d]{8})([a-f\d]{4})([a-f\d]{4})([a-f\d]{4})([a-f\d]{12})$/;Guid.EMPTY=new Guid("00000000-0000-0000-0000-000000000000");return Guid}(),Mscrm;(function(Mscrm){"use strict"})(Mscrm||(Mscrm={}))